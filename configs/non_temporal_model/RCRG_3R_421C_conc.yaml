# RCRG-3R-421C-conc Configuration
# Description: Relational model with 3 Relational layers (512, 256, 128) and 4+2+1 Cliques
# Uses concatenation instead of pooling for scene representation
# Layer 1: 4 cliques (3 players each), Layer 2: 2 cliques (teams), Layer 3: 1 clique (all)

experiment_name: "RCRG_3R_421C_conc"
description: "Stage 2: 3-layer relational reasoning with concatenation pooling."
seed: 42

# Logging and monitoring
use_tensorboard: true
use_wandb: false
wandb_project: "volleyball-activity-recognition"

# Data configuration
data:
  dataset_root: "volleyball-datasets"
  videos_path: "volleyball-datasets/videos"
  annot_path: "data/annot_all.pkl"

  train_split: [1, 3, 6, 7, 10, 13, 15, 16, 18, 22, 23, 31, 32, 36, 38, 39, 40, 41, 42, 48, 50, 52, 53, 54]
  val_split: [0, 2, 8, 12, 17, 19, 24, 26, 27, 28, 30, 33, 46, 49, 51]
  test_split: [4, 5, 9, 11, 14, 20, 21, 25, 29, 34, 35, 37, 43, 44, 45, 47]

  use_augmentation: true
  image_size: 224
  mean: [0.485, 0.456, 0.406]
  std: [0.229, 0.224, 0.225]

# Model configuration
model:
  group_activity:
    name: "RCRG_3R_421C_conc"
    num_classes: 8
    class_names: ["l-pass", "r-pass", "l-spike", "r_spike", "l_set", "r_set", "l_winpoint", "r_winpoint"]

    # Architecture params
    num_relations: 3
    num_cliques: [4, 2, 1]  # Layer 1: 4 cliques, Layer 2: 2 cliques, Layer 3: 1 clique
    hidden_sizes: [512, 256, 128]

    batch_size: 64
    num_workers: 4
    pin_memory: true
    shuffle_train: true

# Training configuration
training:
  use_scheduler: true
  scheduler_type: "reduce_on_plateau"
  scheduler_patience: 3
  scheduler_factor: 0.1
  scheduler_min_lr: 1e-6

  group_activity:
    num_epochs: 20
    learning_rate: 1e-4
    weight_decay: 0.1
    label_smoothing: 0.1
    model_name: "RCRG_3R_421C_conc_best.pth"

    optimizer: "adamW"

    use_early_stopping: true
    early_stopping_patience: 10
    early_stopping_min_delta: 0.0001

    person_classifier_path: "/kaggle/input/person-classifer/results/person_classifier/person_classifier_best/20251214_140908/checkpoints/person_classifier_best.pth"

    resume_from_checkpoint: false
    checkpoint_path: ""

    checkpoint_dir: "checkpoints/RCRG_3R_421C_conc"
    save_best_model: true
    save_every_n_epochs: 2

    log_every_n_batches: 50

    use_amp: true
    device: "auto"

  ddp:
    master_addr: "127.0.0.1"
    master_port: "29500"
    backend: "nccl"

# Evaluation configuration
evaluation:
  batch_size: 64
  results_root: "reslutes_and_logs"
  save_predictions: true
  save_visualizations: true
  plot_confusion_matrix: true
  save_classification_report: true
