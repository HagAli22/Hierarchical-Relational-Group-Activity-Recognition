# Person Action Classification Configuration
# Experiment: Fine-tuning ResNet50 for individual player action recognition

experiment_name: "PersonClassifier_ResNet50"
description: "Stage 1: Individual player action recognition from cropped player regions (ResNet50 Backbone)"
seed: 42

# Logging and monitoring
use_tensorboard: true
use_wandb: false
wandb_project: "volleyball-activity-recognition"

# Data configuration
data:
  # Dataset paths (Adjust these to your local paths)
  # dataset_root: "D:/volleyball-datasets"
  # videos_path:  "D:/volleyball-datasets/videos"
  # annot_path:   "D:/volleyball-datasets/annot_all.pkl"
  
  # Default paths (based on project structure)
  dataset_root: "volleyball-datasets"
  videos_path:  "volleyball-datasets/videos"
  annot_path:   "data/annot_all.pkl"
  
  # Data splits (video IDs)
  train_split: [1, 3, 6, 7, 10, 13, 15, 16, 18, 22, 23, 31, 32, 36, 38, 39, 40, 41, 42, 48, 50, 52, 53, 54]
  val_split: [0, 2, 8, 12, 17, 19, 24, 26, 27, 28, 30, 33, 46, 49, 51]
  test_split: [4, 5, 9, 11, 14, 20, 21, 25, 29, 34, 35, 37, 43, 44, 45, 47]
  
  # Data augmentation
  use_augmentation: true
  image_size: 224
  
  # Augmentation Probabilities
  horizontal_flip_prob: 0.5
  color_jitter_prob: 0.6
  gaussian_blur_prob: 0.3
  random_rotation_degrees: 10
  
  # Normalization (ImageNet pretrained)
  mean: [0.485, 0.456, 0.406]
  std: [0.229, 0.224, 0.225]

# Model configuration
model:
  person_activity:
    name: "PersonClassifier"
    backbone: "resnet50"
    num_classes: 9
    class_names: ["waiting", "setting", "digging", "falling", "spiking", "blocking", "jumping", "moving", "standing"]
    
    # load settings
    batch_size: 256
    num_workers: 4
    pin_memory: True
    shuffle_train: true

# Training configuration
training:
  # Global training settings
  use_scheduler: true
  scheduler_type: "cosine"
  scheduler_patience: 3
  scheduler_factor: 0.1
  scheduler_min_lr: 1e-5
  
  person_activity:
    num_epochs: 10
    learning_rate: 7e-4
    weight_decay: 0.01
    momentum: 0.9
    label_smoothing: 0.1
    
    optimizer: "adamw"  # Options: adam, adamw, sgd
    
    # Early stopping
    use_early_stopping: false
    early_stopping_patience: 10
    early_stopping_min_delta: 0.0001
    
    # Checkpointing
    checkpoint_dir: "checkpoints/person_classifier"
    model_name: "person_classifier_best.pth"
    save_best_model: true
    save_last_model: true
    save_every_n_epochs: 2
    
    # Resume training from checkpoint
    resume_from_checkpoint: False
    checkpoint_path: "/kaggle/input/person-classifer/results/person_classifier/person_classifier_best/20251214_140908/checkpoints/checkpoint_epoch_2.pth"
    
    # Logging
    log_every_n_batches: 50
    
    # Hardware
    use_amp: true
    device: "auto"
  
  # DDP settings (for multi-GPU training)
  ddp:
    master_addr: "127.0.0.1"
    master_port: "29500"
    backend: "nccl"

# Evaluation configuration
evaluation:
  batch_size: 256
  
  # Directories
  results_root: "reslutes_and_logs" # Consolidated text/image logs
  
  # Visualization flags
  save_predictions: true
  save_visualizations: true
  plot_confusion_matrix: true
  save_classification_report: true
